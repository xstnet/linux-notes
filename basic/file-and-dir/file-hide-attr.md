## 文件隐藏属性

文件隐藏属性对系统安全有很大的作用, 只能通过`root`权限来设置, 或使用`sudo`来提升权限

通过`chattr`命令来设置隐藏属性, 不过有一点需要注意, 该命令的参数只能在 `ext2`, `ext3`, `ext4`的文件系统上完整生效, 由于`CentOS 7`默认采用了`xfs`的文件格式, 因此只支持一部分参数

下面就来记录一下`chattr`命令的用法



### chattr

命令格式: `chattr [+-+] [ASacdistu] 文件或目录`

选项与参数: 

-  `+`:  增加某一个特殊参数, 其他原本存在的参数保持不变
-  `-`:  去除某一个特殊参数, 其他原本存在的参数保持不变
-  `=`:  直接设置某个参数, 会清空原有的参数, 使用新的值来替换
-  `A`:  当设置了这个属性后, 存取文件或目录时, 它的存取时间(`atime`)将不会被修改, 什么是`atime`? 其实就是文件或目录的访问时间, 比如`cd dir`, 则此时该文件夹的`atime`就会被更新, 又如`vim a.txt`, 即使不修改文件, 只是用来查看, 也会更新`atime`.  使用`A`这个参数可以来避免`I/O`较慢的机器过度的读写磁盘
-  `S`: 一般文件是非同步写入磁盘的, 调用`sync`则会立即写入到磁盘, 而设置了`S`这个参数后, 将会同步写入到磁盘
-  `a`: 当设置`a`之后, 这个文件只能增加数据, 而不能删除也不能修改数据, 只有`root`才能设置该属性
-  `c`: 设置后写入数据将会自动的压缩, 读取时自动的解压
-  `d`: `dump`程序执行的时候, 该文件或目录不会被备份
-  `i`: `i`的用处很多; 它可以让一个文件 不能被删除, 不能重命名, 不能设置链接, 也无法写入或新增数据, 对系统安全有很大的作用, 只有`root` 有权限设置
-  `s`: 设置该属性后, 如果文件被删除, 它将会被完全的从硬盘删除, 所以如果误删, 完全无法恢复
-  `u`: 与`s` 相反, 设置后如果文件被删除了, 数据内容还真实存在磁盘, 可以用来恢复文件
-  `e`: `e`属性不能被设置, 仅当文件系充为`ext4`是, 所有的文件与目录都会带有`e`的属性, 表明当前使用`ext`文件系统

> 常用的属性是 a与i
> `xfs`仅支持`AadiS`这些, 如果对`xfs`格式设置不支持的属性, 那么将会得到一个 `chattr : 不支持的操作 while setting flag on ...`的错误提示

说完了设置, 那怎么来查看呢, 请往下看

### lsattr

使用 `lsattr`命令来查看隐藏权限, 如

```bash
$ lsattr
-------------e-- ./ttt
-------------e-- ./index.php
-------------e-- ./test.txt

$  chattr +i test.txt
$ lsattr
-------------e-- ./ttt
-------------e-- ./index.php
----i--------e-- ./test.txt
$ mv test.txt test1.txt
mv: cannot move ‘test.txt’ to ‘test1.txt’: Operation not permitted
```

从上面可以看到, 对文件设置了`i`属性之后, 果然不能改名了