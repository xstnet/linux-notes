## 执行历史命令

我们知道`history`命令可以查看历史执行的命令, 然后列出来, 那么列出来的命令可以直接执行吗, 除了手动复制去执行还有别的办法吗?

当然是有的, 下面来介绍一下 `!`的用法, 在这之前, 先看一下我的`history`吧

```bash
$ history

 2279  2020-11-28 16:57:19 echo $COLUMNS
 2280  2020-11-28 16:58:08 echo $COLUMNS
 2281  2020-11-28 16:58:31 echo $LINES
 2282  2020-11-28 16:59:47 echo $0
 2283  2020-11-28 17:00:01 echo $0
 2284  2020-11-28 17:00:05 echo $$
 2285  2020-11-28 17:00:12 ps -ef | grep 28366
 2286  2020-11-28 17:01:03 echo $0
 2287  2020-11-28 17:03:28 echo $?
 2288  2020-11-28 17:14:57 history
```



### 执行指定序号的命令  !number

在上面的历史命令列表中, 假如我想再次执行 `2285`条命令, 也就是 `ps -ef | grep 28366`, 要怎么做呢?

使用`!number` 即可, 这个`number`代表一个序号, 在这里就是`2285`

```bash
$ !2285
ps -ef | grep 28366
root     10277 28366  0 17:17 pts/0    00:00:00 ps -ef
root     10278 28366  0 17:17 pts/0    00:00:00 grep --color=auto 28366
root     28366 28362  0 15:51 pts/0    00:00:00 -bash
```

使用`!number`执行之后, 当我们再次使用`history`查看时并不会记录 `!2285`这个命令, 而是真正执行的命令

### 执行以 command开头的命令 !command

除了`!number`之外还有别的方法吗, 也是有的, 那就是`!command`, 这个`command`可以是一个完整的命令, 也可以是一个命令开头的部分

> 因为将会查找以 `command`开头的第一个命令, 所以命令不能从中间开始写



如果这里我还想执行`2285`号命令, 此时可以这样写

```bash
$ !ps
ps -ef | grep 28366
root     10990 28366  0 17:22 pts/0    00:00:00 ps -ef
root     10991 28366  0 17:22 pts/0    00:00:00 grep --color=auto 28366
root     28366 28362  0 15:51 pts/0    00:00:00 -bash
```

那么则将会去查找`ps`开头的第一个命令, 这样也能得到想要的结果, 同样的 `!command`也不会记录到 `history`中



### 执行上一个命令 !!

直接使用 `!!`将会执行上一条命令, 那么它的用处再哪呢?

假如我们执行了一个相当长的命令, 但是执行后发现没有权限, 需要添加`sudo`, 这个时修往往会按一下`方向键上`, 然后再开头加上 `sudo `来再次执行

如查使用`!!`那么将会多出一个选择, 那就是 直接输入`sudo !!`即可

